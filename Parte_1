--1.1
CREATE TABLE  OIJ_TEMP (
    delito varchar(1000), 
    subdelito varchar(1000), 
    fecha varchar(1000), 
	hora varchar(1000),
    victima varchar(1000), 
    subvictima varchar(1000), 
    edad varchar(1000), 
    genero varchar(1000), 
    nacionalidad varchar(1000), 
    provincia varchar(1000), 
    canton varchar(1000), 
    distrito varchar(1000)
);

COPY oij_temp 
FROM 'C:\ProgramData\Microsoft\Windows\Start Menu\Programs\PostgreSQL 16\Documentation\oij.csv' 
DELIMITER ',' 
CSV HEADER;

ALTER TABLE  
DROP COLUMN distrito;


create table  INEC_TEMP(
	canton_o_distrito varchar(1000),
	quinceanios_o_mas int,
	participacion float,
	ocupacion float,
	desempleo float,
	inactivos_economicos float,
	dependencia_economica float,
	primario float,
	secundario float,
	terciario float
);



--1.2
create table Provincias (
	ID_Provincia int primary key GENERATED BY DEFAULT AS IDENTITY (start with 1) not null,
	nombre_provincia varchar(100) not null unique
);

create table cantones (
	ID_Canton int primary key GENERATED BY DEFAULT AS IDENTITY (start with 1) not null,
	nombre varchar(100) not null,
	ID_Provincia int not null,
	constraint fk_provincia foreign key (ID_Provincia) references Provincias(ID_Provincia)
);

CREATE TABLE Subdelito (
    ID_SubDelito int primary key GENERATED BY DEFAULT AS IDENTITY (start with 1) not null,
    Tipo_subdelito VARCHAR(255) NOT NULL
);

CREATE TABLE Delito (
    ID_Delito int primary key GENERATED BY DEFAULT AS IDENTITY (start with 1) not null,
    Tipo_delito VARCHAR(255) NOT NULL,
    ID_SubDelito INT NOT NULL,
    FOREIGN KEY (ID_SubDelito) REFERENCES Subdelito(ID_SubDelito)
);

CREATE TABLE Edad (
    ID_edad int primary key GENERATED BY DEFAULT AS IDENTITY (start with 1) not null,
    Edad VARCHAR(255) NOT NULL
);

CREATE TABLE Subvictima (
    ID_subvictima int primary key GENERATED BY DEFAULT AS IDENTITY (start with 1) not null,
    Tipo_subvictima VARCHAR(255) NOT NULL
);

CREATE TABLE Victima (
    ID_victima int primary key GENERATED BY DEFAULT AS IDENTITY (start with 1) not null,
    Tipo_victima VARCHAR(255) NOT NULL,
    ID_Subvictima INT NOT NULL,
    FOREIGN KEY (ID_Subvictima) REFERENCES Subvictima(ID_subvictima)
);

create table genero (
	ID_Genero int primary key GENERATED BY DEFAULT AS IDENTITY (start with 1) not null,
	tipo varchar(100) not null unique
);

create table nacionalidad (
	ID_nacionalidad int primary key GENERATED BY DEFAULT AS IDENTITY (start with 1) not null,
	nombre varchar(100) not null unique
);

CREATE TABLE Delito_cometido (
	ID_DelitoCometido int primary key GENERATED BY DEFAULT AS IDENTITY (start with 1) not null,
 	ID_Delito INT NOT NULL,
    	Fecha DATE NOT NULL,
    	Hora TIMESTAMP NOT NULL,
    	ID_Victima INT NOT NULL,
    	ID_Edad INT NOT NULL,
	ID_Genero INT NOT NULL,
	ID_Nacionalidad INT NOT NULL,
    	ID_Canton INT NOT NULL,
    	FOREIGN KEY (ID_Delito) REFERENCES Delito(ID_Delito),
    	FOREIGN KEY (ID_Victima) REFERENCES Victima(ID_victima),
    	FOREIGN KEY (ID_Edad) REFERENCES Edad(ID_edad),
	FOREIGN KEY (ID_Genero) REFERENCES Genero(ID_Genero),
	FOREIGN KEY (ID_Nacionalidad) REFERENCES Nacionalidad(ID_nacionalidad),
    	FOREIGN KEY (ID_Canton) REFERENCES Cantones(ID_Canton)
);
